webpackJsonp([4],{31:function(e,t){function n(e){function t(e,t){var n=arguments.callee;t||(t={});for(var a in e){var r=Object.prototype.toString.call(e[a]);"[object Object]"===r?n(e[a],t[a]):"[object Array]"===r?t[a]=e[a].concat():"object"!=typeof e[a]&&(t[a]=e[a])}}var n=Object.prototype.toString.call(e);if("[object Object]"!==n)throw new Error("函数objectAssign(obj,...)，参数必须为对象类型，当前类型："+n);if(arguments.length>1)for(var a=1;a<=arguments.length-1;a++)t(arguments[a],e);return e}e.exports=n},34:function(e,t,n){e.exports={DB_NAME:"living-bill",DB_VERSION:1}},35:function(e,t,n){function a(){this.TABLE_BILL="bill"}var r=n(31),o=n(34);a.prototype.index_date=["date"],a.prototype.index_type="type",a.prototype.keyRange={atMonth:function(e){return IDBKeyRange.bound([e[0]+"-01"],[e[0]+"-31"])},inType:function(e){return IDBKeyRange.only(e)}},a.prototype.open=function(e){var t=this,n=window.indexedDB.open(o.DB_NAME,o.DB_VERSION);n.onerror=function(e){console.log(e.currentTarget.error.message)},n.onsuccess=function(t){var n=t.target.result;e(n)},n.onupgradeneeded=function(e){var n,a=e.target.result;if(a.objectStoreNames.contains(t.TABLE_BILL)){var r=e.target.transaction;n=r.objectStore(t.TABLE_BILL);for(var i=n.indexNames,c=0;c<i.length;c++)n.deleteIndex(i[c])}else n=a.createObjectStore(t.TABLE_BILL,{autoIncrement:!0});n.createIndex("index_date",t.index_date,{unique:!1}),n.createIndex("index_type",t.index_type,{unique:!1}),console.log("DB version changed to "+o.DB_VERSION)}},a.prototype.add=function(e,t){this.open(function(n){var a=n.transaction(e,"readwrite"),r=a.objectStore(e);"[object Array]"===Object.prototype.toString.apply(t)?t.forEach(function(e){r.add(e)}):r.add(t),n.close()})},a.prototype.save=function(e,t,n){this.open(function(a){var o=a.transaction(e,"readwrite"),i=o.objectStore(e),c=i.get(+t);c.onsuccess=function(e){var a=e.target.result;r(a,n),i.put(a,+t)}})},a.prototype.del=function(e,t){this.open(function(n){var a=n.transaction(e,"readwrite"),r=a.objectStore(e);t?r["delete"](+t):r.clear()})},a.prototype.get=function(e,t,n){this.open(function(a){var r=a.transaction(e,"readonly"),o=r.objectStore(e),i=o.get(+t);i.onsuccess=function(e){var t=e.target.result;n(t)}})},a.prototype.getList=function(e,t,n,a){this.open(function(r){var o,i=r.transaction(e,"readonly"),c=i.objectStore(e);if(n&&a){"string"!=typeof n&&(n=n.join("_"));var l=c.index("index_"+n);o=l.openCursor(a)}else o=c.openCursor();var s=[];o.onsuccess=function(e){var n=e.target.result;if(n){var a=n.value;a.id=n.primaryKey,s.push(a),n["continue"]()}else t(s),r.close()}})},e.exports=new a},51:function(e,t,n){(function(t){var n=t.createClass({displayName:"Loader",render:function(){return t.createElement("div",{className:"loading"},t.createElement("div",{className:"loader loader-primary loader-rounded"},t.createElement("div",{className:"loader-bounce1"}),t.createElement("div",{className:"loader-bounce2"}),t.createElement("div",{className:"loader-bounce3"})))}});e.exports=n}).call(t,n(3))},294:function(e,t,n){(function(t){var a=n(42).Link,r=n(52),o=n(33),i=n(51),c=n(35),l=n(53);e.exports=t.createClass({displayName:"module.exports",getInitialState:function(){return{loading:!0,list:[]}},componentWillMount:function(){c.getList(c.TABLE_BILL,function(e){e.sort(function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()}),this.setState({loading:!1,list:e})}.bind(this),c.index_type,c.keyRange.inType(this.props.params.type))},getItem:function(e){var t=new Date(e.date.replace(/-/g,"/"));return{id:e.id,day:t.getDate(),month:t.getMonth()+1,year:t.getFullYear(),icon:l[e.type].icon,name:l[e.type].name,color:l[e.type].color,amount:e.amount}},render:function(){if(this.state.loading)return t.createElement(i,null);var e=this.state.list,n=0;return e.forEach(function(e){n+=+e.amount}),n=+n.toFixed(2),t.createElement("div",{className:"container container-column container-fill"},t.createElement("div",{className:"view"},t.createElement(r,{title:"【"+l[this.props.params.type].name+"】明细",leftNav:{},rightNav:{icon:"plus",href:"/edit/"+this.props.params.type}}),t.createElement("div",{className:"item item-header"},"小计：",n," 元"),t.createElement("div",{className:"container container-scrollable container-fill"},e.length?t.createElement("ul",{className:"list touch-auto margin-0"},e.map(function(e,n){return e=this.getItem(e),t.createElement("li",{key:n,className:"item item-linked"},t.createElement(a,{to:"/edit/"+this.props.params.type+"/"+e.id,style:{display:"flex",alignItems:"center"}},t.createElement("div",{className:"text-center",style:{lineHeight:1,borderRight:"1px solid #ccc",paddingRight:10,marginRight:10}},t.createElement("small",null,e.year,"-",e.month<10?"0"+e.month:e.month,"-",e.day<10?"0"+e.day:e.day)),t.createElement(o,{name:e.icon,color:e.color,size:"30"}),t.createElement("strong",{style:{marginLeft:"5px",verticalAlign:"text-top",flexGrow:1}},e.name),t.createElement("div",null,t.createElement("span",null,"￥",e.amount," "),t.createElement(o,{name:"right",color:"#ccc",size:"16",style:{margin:"0 0 -2px 10px"}}))))}.bind(this))):t.createElement("h3",{className:"text-center padding-v-lg"},"没有数据！"))))}})}).call(t,n(3))}});